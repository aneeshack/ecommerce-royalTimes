<%- include('../layouts/admin/header',{title: editMode ? 'Edit Product' : 'Add Product' }) %>

  <!-- Bootstrap CSS -->
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <!-- font awsome adding link -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Cropper CSS for image cropping -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" />
  </head>

  <body>
    <div class="container mt-5">
      <h1 class="mb-4">
        <%= editMode ? 'Edit Product' : 'Add Product' %>
        <span id="messageShow" class=" text-danger"></span>
      </h1>
      <% if (typeof successMessage !=='undefined' && successMessage.length> 0) { %>
        <div class="alert alert-success">
          <%= successMessage %>
        </div>
        <% } %>

          <% if (typeof errorMessage !=='undefined' && errorMessage.length> 0) { %>
            <div class="alert alert-danger">
              <ul>
                <% errorMessage.forEach(error=> { %>
                  <li>
                    <%= error %>
                  </li>
                  <% }); %>
              </ul>
            </div>
            <% } %>
              <form
                action="<%= editMode ? `/admin/product/editProduct/${product._id}` : '/admin/product/addProduct' %> "
                method="post" id="upload-form" enctype="multipart/form-data">
                <div class="form-group">
                  <label for="productName">Product Name</label>
                  <input type="text" class="form-control" id="productName" placeholder="Enter product name"
                    name="productName" value="<%= editMode ? product.productName  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productPrice">Product Price</label>
                  <input type="number" class="form-control" id="productPrice" placeholder="Enter product price"
                    name="price" value="<%= editMode ? product.price  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productStock">Stock</label>
                  <input type="number" class="form-control" id="productStock" placeholder="Enter stock quantity"
                    name="stock" value="<%= editMode ? product.stock : '' %>" required>
                </div>
                <div class="form-group">
                  <label for="productWarranty">Warranty (year)</label>
                  <input type="number" class="form-control" id="productWarranty" placeholder="Enter warranty duration"
                    name="warranty" value="<%= editMode ? product.warranty : '' %>" required>
                </div>
                <div class="form-group">
                  <label for="productRating">Rating</label>
                  <input type="number" class="form-control" id="productRating" placeholder="Enter product rating"
                    name="rating" value="<%= editMode ? product.rating : '' %>" required>
                </div>

                <!-- new -->
                <div class="form-group">
                  <label for="productName">Watch Type</label>
                  <input type="text" class="form-control" id="watchType" placeholder="Enter product watchType"
                    name="watchType" value="<%= editMode ? product.watchType  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productName">Case Material</label>
                  <input type="text" class="form-control" id="CaseMaterial" placeholder="Enter product CaseMaterial"
                    name="CaseMaterial" value="<%= editMode ? product.CaseMaterial  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productName">Dial Colour</label>
                  <input type="text" class="form-control" id="dialColour" placeholder="Enter product dialColour"
                    name="dialColour" value="<%= editMode ? product.dialColour  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productName">Strap Material</label>
                  <input type="text" class="form-control" id="strapMaterial" placeholder="Enter product strapMaterial"
                    name="strapMaterial" value="<%= editMode ? product.strapMaterial  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productName">Model Number</label>
                  <input type="text" class="form-control" id="ModelNumber" placeholder="Enter product ModelNumber"
                    name="ModelNumber" value="<%= editMode ? product.ModelNumber  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productName">Features</label>
                  <input type="text" class="form-control" id="features" placeholder="Enter product features"
                    name="features" value="<%= editMode ? product.features  :'' %>" required>
                </div>
                <div class="form-group">
                  <label for="productBrand">Brand</label>
                  <select class="form-control" id="productBrand" name="brand" required>
                    <% brands.forEach(brand=> { %>
                      <option value="<%= brand.name %>">
                        <%= brand.name %>
                      </option>
                      <% }) %>
                  </select>
                </div>
                <div class="form-group">
                  <label for="productCategory">Category</label>
                  <select class="form-control" id="productCategory" name="category" required>
                    <% categories.forEach(category=> { %>
                      <option value="<%= category.name %>">
                        <%= category.name %>
                      </option>
                      <% }) %>
                  </select>
                </div>



                <h2>Select Three Images</h2>
                <input type="file" accept="image/*" name="images" multiple onchange="previewImages(event)">
                <div id="preview"></div>
                <div id="message"></div>
                <br>
                <br>
                <button type="submit" class="btn btn-primary">
                  <%= editMode ? 'Update Product' : 'Add Product' %>
                </button>
              </form>
    </div>

    <button id="buttonEvent">hello</button>
    <div id="show"></div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>


    <script>
      document.getElementById('buttonEvent').addEventListener('click', function () {
        let container = document.createElement('div');
        let show = document.getElementById('show')
        container.textContent = 'hello friends '
        let close = document.createElement('button')
        close.innerHTML = '&times;'
        close.style.position = 'abosolute'
        close.onclick = function () {
          show.removeChild(container)
        }
        container.appendChild(close)
        show.appendChild(container)
      })
    </script>



    <!-- <script>
    function previewImages(event) {
      var preview = document.getElementById('preview');
      preview.innerHTML = '';
      
      var files = event.target.files;
      
      for (var i = 0; i < files.length; i++) {
        var file = files[i];
        var reader = new FileReader();

        reader.onload = function(event) {
          var img = document.createElement('img');
          img.src = event.target.result;
          img.style.width = '200px';
          img.style.height = 'auto';
          preview.appendChild(img);
        };

        reader.readAsDataURL(file);
      }
    }
  </script> -->

  <!-- image selecting with close button -->
    <!-- <script>

      function previewImages(event) {

        let preview = document.getElementById('preview');
        preview.innerHTML = '';

        let files = event.target.files;
        for (let i = 0; i < files.length; i++) {
          let file = files[i];
          let reader = new FileReader()

          reader.onload = function (event) {

            var imageContainer = document.createElement('div');
            imageContainer.style.position = 'relative';
            imageContainer.style.display = 'inline-block';

            let img = document.createElement('img');
            img.src = event.target.result;
            img.style.width = '300px';
            img.style.height = 'auto';

            var closeButton = document.createElement('button');
            closeButton.innerHTML = '&times;';
            closeButton.style.position = 'absolute';
            closeButton.style.backgroundColor = 'red';
            closeButton.style.fontSize ='20px';
            closeButton.style.border = 'none';
            closeButton.style.width = '30px';
            closeButton.style.height = '30px';

            imageContainer.appendChild(img)
            imageContainer.appendChild(closeButton)
            preview.appendChild(imageContainer)

            closeButton.onclick = function () {
              preview.removeChild(imageContainer)
            }




          }

          reader.readAsDataURL(file);



        }

      }

    </script> -->


<script>

  function previewImages(event) {

    let preview = document.getElementById('preview');
    preview.innerHTML = '';

    let files = event.target.files;
    for (let i = 0; i < files.length; i++) {
      let file = files[i];
      let reader = new FileReader()

      reader.onload = function (event) {

        var imageContainer = document.createElement('div');
        imageContainer.style.position = 'relative';
        imageContainer.style.display = 'inline-block';
        
        let img = document.createElement('img');
        img.src = event.target.result;
        img.style.width = '300px';
        img.style.height = 'auto';

        var closeButton = document.createElement('button');
        closeButton.innerHTML = '&times;';
        closeButton.style.position = 'absolute';
        closeButton.style.backgroundColor = 'red';
        closeButton.style.fontSize ='20px';
        closeButton.style.border = 'none';
        closeButton.style.width = '30px';
        closeButton.style.height = '30px';

        imageContainer.appendChild(img)
        imageContainer.appendChild(closeButton)
        preview.appendChild(imageContainer)

        closeButton.onclick = function () {
          preview.removeChild(imageContainer)
        }




      }

      reader.readAsDataURL(file);



    }

  }

</script>
    <%- include('../layouts/admin/adminFooter') %>